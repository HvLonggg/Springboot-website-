<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <title>ThÃªm Ä‘á»“ Äƒn má»›i</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-success">ğŸœ ThÃªm mÃ³n Äƒn má»›i</h2>
        <a href="/admin/snacks" class="btn btn-secondary">â¬… Quay láº¡i</a>
    </div>

    <form th:action="@{/admin/snacks/save}"
          th:object="${snack}"
          method="post"
          enctype="multipart/form-data"
          class="row g-3 needs-validation"
          novalidate>

        <div class="col-md-6">
            <label for="name" class="form-label">TÃªn mÃ³n</label>
            <input type="text" id="name" class="form-control" th:field="*{name}" required>
        </div>

        <div class="col-md-6">
            <label for="category" class="form-label">Danh má»¥c</label>
            <input type="text" id="category" class="form-control" th:field="*{category}" required>
        </div>

        <div class="col-md-12">
            <label for="description" class="form-label">MÃ´ táº£</label>
            <input type="text" id="description" class="form-control" th:field="*{description}" required>
        </div>

        <div class="col-md-4">
            <label for="price" class="form-label">GiÃ¡ (â‚«)</label>
            <!-- Äá»•i input number thÃ nh text Ä‘á»ƒ há»— trá»£ Ä‘á»‹nh dáº¡ng giÃ¡ -->
            <input type="text" id="price" class="form-control" th:field="*{price}" required oninput="formatPriceInput(this)">
        </div>

        <div class="col-md-4">
            <label for="stockQuantity" class="form-label">Sá»‘ lÆ°á»£ng tá»“n</label>
            <input type="number" id="stockQuantity" class="form-control" th:field="*{stockQuantity}" min="0" required>
        </div>

        <div class="col-md-4">
            <label for="inStock" class="form-label d-block">CÃ²n hÃ ng</label>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="inStock" th:field="*{inStock}">
                <label class="form-check-label" for="inStock">CÃ²n hÃ ng</label>
            </div>
        </div>

        <div class="col-md-12">
            <label for="imageFile" class="form-label">Chá»n áº£nh mÃ³n Äƒn</label>
            <input type="file" id="imageFile" name="imageFile" class="form-control" accept="image/*" required>
        </div>

        <div class="col-12">
            <button type="submit" class="btn btn-primary">ğŸ’¾ LÆ°u mÃ³n Äƒn</button>
        </div>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // HÃ m Ä‘á»‹nh dáº¡ng giÃ¡ nháº­p vÃ o: thÃªm dáº¥u cháº¥m phÃ¢n cÃ¡ch hÃ ng nghÃ¬n
    function formatPriceInput(input) {
        let value = input.value;

        // Loáº¡i bá» táº¥t cáº£ kÃ½ tá»± khÃ´ng pháº£i sá»‘
        value = value.replace(/\D/g, '');

        // Äáº£o ngÆ°á»£c chuá»—i Ä‘á»ƒ dá»… thÃªm dáº¥u cháº¥m tá»«ng 3 chá»¯ sá»‘
        let reversed = value.split('').reverse().join('');

        // ThÃªm dáº¥u cháº¥m tá»«ng 3 chá»¯ sá»‘
        let withDots = reversed.match(/.{1,3}/g).join('.');

        // Äáº£o ngÆ°á»£c láº¡i chuá»—i Ä‘Ã£ thÃªm dáº¥u cháº¥m
        let formatted = withDots.split('').reverse().join('');

        input.value = formatted;
    }

    // Khi submit form, bá» dáº¥u cháº¥m ra Ä‘á»ƒ gá»­i dá»¯ liá»‡u chuáº©n vá» backend
    document.querySelector('form').addEventListener('submit', function(e) {
        const priceInput = document.getElementById('price');
        priceInput.value = priceInput.value.replace(/\./g, '');
    });

    // Bootstrap form validation
    (function () {
        'use strict'
        const forms = document.querySelectorAll('.needs-validation')
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault()
                    event.stopPropagation()
                }
                form.classList.add('was-validated')
            }, false)
        })
    })()
</script>

</body>
</html>
